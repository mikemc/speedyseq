<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Agglomerate taxa using taxonomy. — tax_glom • speedyseq</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Agglomerate taxa using taxonomy. — tax_glom" />
<meta property="og:description" content="This method merges species that have the same taxonomy at a certain
taxonomic rank. Its approach is analogous to tip_glom(), but
uses categorical data instead of a tree. In principal, other categorical
data known for all taxa could also be used in place of taxonomy, but for the
moment, this must be stored in the taxonomyTable of the data. Also,
columns/ranks to the right of the rank chosen to use for agglomeration will
be replaced with NA, because they should be meaningless following
agglomeration." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">speedyseq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.3.9018</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mikemc/speedyseq/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Agglomerate taxa using taxonomy.</h1>
    <small class="dont-index">Source: <a href='https://github.com/mikemc/speedyseq/blob/master/R/agglomeration.R'><code>R/agglomeration.R</code></a></small>
    <div class="hidden name"><code>tax_glom.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This method merges species that have the same taxonomy at a certain
taxonomic rank. Its approach is analogous to <code><a href='tip_glom.html'>tip_glom()</a></code>, but
uses categorical data instead of a tree. In principal, other categorical
data known for all taxa could also be used in place of taxonomy, but for the
moment, this must be stored in the <code>taxonomyTable</code> of the data. Also,
columns/ranks to the right of the rank chosen to use for agglomeration will
be replaced with <code>NA</code>, because they should be meaningless following
agglomeration.</p>
    </div>

    <pre class="usage"><span class='fu'>tax_glom</span><span class='op'>(</span>
  <span class='va'>physeq</span>,
  taxrank <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/phyloseq/man/rank_names.html'>rank_names</a></span><span class='op'>(</span><span class='va'>physeq</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,
  NArm <span class='op'>=</span> <span class='cn'>TRUE</span>,
  bad_empty <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='st'>""</span>, <span class='st'>" "</span>, <span class='st'>"\t"</span><span class='op'>)</span>,
  reorder <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>physeq</th>
      <td><p>(Required). <code><a href='https://rdrr.io/pkg/phyloseq/man/phyloseq-class.html'>phyloseq-class()</a></code> or <code><a href='https://rdrr.io/pkg/phyloseq/man/tax_table-methods.html'>tax_table()</a></code>.</p></td>
    </tr>
    <tr>
      <th>taxrank</th>
      <td><p>A character string specifying the taxonomic level that you
want to agglomerate over. Should be among the results of
<code><a href='https://rdrr.io/pkg/phyloseq/man/rank_names.html'>rank_names(physeq)</a></code>. The default value is <code>rank_names(physeq)[1]</code>, which
may agglomerate too broadly for a given experiment. You are strongly
encouraged to try different values for this argument.</p></td>
    </tr>
    <tr>
      <th>NArm</th>
      <td><p>(Optional). Logical, length equal to one. Default is <code>TRUE</code>.
CAUTION. The decision to prune (or not) taxa for which you lack categorical
data could have a large effect on downstream analysis.  You may want to
re-compute your analysis under both conditions, or at least think carefully
about what the effect might be and the reasons explaining the absence of
information for certain taxa. In the case of taxonomy, it is often a result
of imprecision in taxonomic designation based on short phylogenetic
sequences and a patchy system of nomenclature.  If this seems to be an issue
for your analysis, think about also trying the nomenclature-agnostic
<code><a href='tip_glom.html'>tip_glom()</a></code> method if you have a phylogenetic tree available.</p></td>
    </tr>
    <tr>
      <th>bad_empty</th>
      <td><p>(Optional). Character vector. Default: <code><a href='https://rdrr.io/r/base/c.html'>c(NA, "", " ", "\t")</a></code>. Defines the bad/empty values that should be ignored and/or
considered unknown. They will be removed from the internal agglomeration
vector derived from the argument to <code>tax</code>, and therefore agglomeration will
not combine taxa according to the presence of these values in <code>tax</code>.
Furthermore, the corresponding taxa can be optionally pruned from the output
if <code>NArm</code> is set to <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>reorder</th>
      <td><p>Logical specifying whether to reorder the taxa by taxonomy
strings or keep initial order. Ignored if <code>physeq</code> has a phylogenetic tree.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A taxonomically-agglomerated, optionally-pruned, object with class
matching the class of <code>physeq</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is the speedyseq reimplementation of <code><a href='https://rdrr.io/pkg/phyloseq/man/tax_glom.html'>phyloseq::tax_glom()</a></code>. It should
produce results that are identical to phyloseq up to taxon order.</p>
<p>If <code>x</code> is a phyloseq object with a phylogenetic tree, then the new taxa will
be ordered as they are in the tree. Otherwise, the taxa order can be
controlled by the <code>reorder</code> argument, which behaves like the <code>reorder</code>
argument in <code><a href='https://rdrr.io/r/base/rowsum.html'>base::rowsum()</a></code>. <code>reorder = FALSE</code> will keep taxa in
the original order determined by when the member of each group first appears
in <code><a href='https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html'>taxa_names(x)</a></code>; <code>reorder = TRUE</code> will order new taxa alphabetically
according to taxonomy (string of concatenated rank values).</p>
<p>Acknowledgements: Documentation and general strategy derived from
<code><a href='https://rdrr.io/pkg/phyloseq/man/tax_glom.html'>phyloseq::tax_glom()</a></code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/phyloseq/man/tax_glom.html'>phyloseq::tax_glom()</a></code></p>
<p><code><a href='tip_glom.html'>tip_glom()</a></code></p>
<p><code><a href='https://rdrr.io/pkg/phyloseq/man/prune_taxa-methods.html'>prune_taxa()</a></code></p>
<p><code><a href='merge_taxa_vec.html'>merge_taxa_vec()</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>GlobalPatterns</span><span class='op'>)</span>
<span class='co'># print the available taxonomic ranks</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/phyloseq/man/tax_table-methods.html'>tax_table</a></span><span class='op'>(</span><span class='va'>GlobalPatterns</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "Kingdom" "Phylum"  "Class"   "Order"   "Family"  "Genus"   "Species"</div><div class='input'><span class='co'># agglomerate at the Family taxonomic rank</span>
<span class='op'>(</span><span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fu'>tax_glom</span><span class='op'>(</span><span class='va'>GlobalPatterns</span>, taxrank<span class='op'>=</span><span class='st'>"Family"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; phyloseq-class experiment-level object
#&gt; otu_table()   OTU Table:          [ 341 taxa and 26 samples ]:
#&gt; sample_data() Sample Data:        [ 26 samples by 7 sample variables ]:
#&gt; tax_table()   Taxonomy Table:     [ 341 taxa by 7 taxonomic ranks ]:
#&gt; phy_tree()    Phylogenetic Tree:  [ 341 tips and 340 internal nodes ]:
#&gt; taxa are rows</div><div class='input'><span class='co'># How many taxa before/after agglomeration?</span>
<span class='fu'><a href='https://rdrr.io/pkg/phyloseq/man/ntaxa-methods.html'>ntaxa</a></span><span class='op'>(</span><span class='va'>GlobalPatterns</span><span class='op'>)</span>; <span class='fu'><a href='https://rdrr.io/pkg/phyloseq/man/ntaxa-methods.html'>ntaxa</a></span><span class='op'>(</span><span class='va'>x1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 19216</div><div class='output co'>#&gt; [1] 341</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Michael McLaren.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


