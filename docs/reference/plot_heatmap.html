<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create an ecologically-organized heatmap using ggplot2 graphics — plot_heatmap • speedyseq</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create an ecologically-organized heatmap using ggplot2 graphics — plot_heatmap" />
<meta property="og:description" content="There are many useful examples of phyloseq heatmap graphics in the
phyloseq online tutorials.
In a 2010 article in BMC Genomics, Rajaram and Oono show describe an
approach to creating a heatmap using ordination methods to organize the
rows and columns instead of (hierarchical) cluster analysis. In many cases
the ordination-based ordering does a much better job than h-clustering.
An immediately useful example of their approach is provided in the NeatMap
package for R. The NeatMap package can be used directly on the abundance
table (otu_table-class) of phylogenetic-sequencing data, but
the NMDS or PCA ordination options that it supports are not based on ecological
distances. To fill this void, phyloseq provides the plot_heatmap()
function as an ecology-oriented variant of the NeatMap approach to organizing
a heatmap and build it using ggplot2 graphics tools.
The distance and method arguments are the same as for the
plot_ordination function, and support large number of
distances and ordination methods, respectively, with a strong leaning toward
ecology.
This function also provides the options to re-label the OTU and sample
axis-ticks with a taxonomic name and/or sample variable, respectively,
in the hope that this might hasten your interpretation of the patterns
(See the sample.label and taxa.label documentation, below).
Note that this function makes no attempt to overlay hierarchical
clustering trees on the axes, as hierarchical clustering is not used to
organize the plot. Also note that each re-ordered axis repeats at the edge,
and so apparent clusters at the far right/left or top/bottom of the
heat-map may actually be the same. For now, the placement of this edge
can be considered arbitrary, so beware of this artifact of this graphical
representation. If you benefit from this phyloseq-specific implementation
of the NeatMap approach, please cite both our packages/articles." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">speedyseq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.3.9008</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mikemc/speedyseq/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create an ecologically-organized heatmap using ggplot2 graphics</h1>
    <small class="dont-index">Source: <a href='https://github.com/mikemc/speedyseq/blob/master/R/plot-methods.R'><code>R/plot-methods.R</code></a></small>
    <div class="hidden name"><code>plot_heatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>There are many useful examples of phyloseq heatmap graphics in the
<a href='http://joey711.github.io/phyloseq/plot_heatmap-examples'>phyloseq online tutorials</a>.
In a 2010 article in BMC Genomics, Rajaram and Oono show describe an
approach to creating a heatmap using ordination methods to organize the
rows and columns instead of (hierarchical) cluster analysis. In many cases
the ordination-based ordering does a much better job than h-clustering.
An immediately useful example of their approach is provided in the NeatMap
package for R. The NeatMap package can be used directly on the abundance
table (<code><a href='https://rdrr.io/pkg/phyloseq/man/otu_table-class.html'>otu_table-class</a></code>) of phylogenetic-sequencing data, but
the NMDS or PCA ordination options that it supports are not based on ecological
distances. To fill this void, phyloseq provides the <code>plot_heatmap()</code>
function as an ecology-oriented variant of the NeatMap approach to organizing
a heatmap and build it using ggplot2 graphics tools.
The <code>distance</code> and <code>method</code> arguments are the same as for the
<code><a href='https://rdrr.io/pkg/phyloseq/man/plot_ordination.html'>plot_ordination</a></code> function, and support large number of
distances and ordination methods, respectively, with a strong leaning toward
ecology.
This function also provides the options to re-label the OTU and sample
axis-ticks with a taxonomic name and/or sample variable, respectively,
in the hope that this might hasten your interpretation of the patterns
(See the <code>sample.label</code> and <code>taxa.label</code> documentation, below).
Note that this function makes no attempt to overlay hierarchical
clustering trees on the axes, as hierarchical clustering is not used to
organize the plot. Also note that each re-ordered axis repeats at the edge,
and so apparent clusters at the far right/left or top/bottom of the
heat-map may actually be the same. For now, the placement of this edge
can be considered arbitrary, so beware of this artifact of this graphical
representation. If you benefit from this phyloseq-specific implementation
of the NeatMap approach, please cite both our packages/articles.</p>
    </div>

    <pre class="usage"><span class='fu'>plot_heatmap</span><span class='op'>(</span>
  <span class='va'>physeq</span>,
  method <span class='op'>=</span> <span class='st'>"NMDS"</span>,
  distance <span class='op'>=</span> <span class='st'>"bray"</span>,
  sample.label <span class='op'>=</span> <span class='cn'>NULL</span>,
  taxa.label <span class='op'>=</span> <span class='cn'>NULL</span>,
  low <span class='op'>=</span> <span class='st'>"#000033"</span>,
  high <span class='op'>=</span> <span class='st'>"#66CCFF"</span>,
  na.value <span class='op'>=</span> <span class='st'>"black"</span>,
  trans <span class='op'>=</span> <span class='fu'>log_trans</span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span>,
  max.label <span class='op'>=</span> <span class='fl'>250</span>,
  title <span class='op'>=</span> <span class='cn'>NULL</span>,
  sample.order <span class='op'>=</span> <span class='cn'>NULL</span>,
  taxa.order <span class='op'>=</span> <span class='cn'>NULL</span>,
  first.sample <span class='op'>=</span> <span class='cn'>NULL</span>,
  first.taxa <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>physeq</th>
      <td><p>(Required). The data, in the form of an instance of the
<code><a href='https://rdrr.io/pkg/phyloseq/man/phyloseq-class.html'>phyloseq-class</a></code>. This should be what you get as a result
from one of the
<code><a href='https://rdrr.io/pkg/phyloseq/man/import.html'>import</a></code> functions, or any of the processing downstream.
No data components beyond the <code><a href='https://rdrr.io/pkg/phyloseq/man/otu_table-methods.html'>otu_table</a></code> are strictly
necessary, though they may be useful if you want to re-label the
axis ticks according to some observable or taxonomic rank, for instance,
or if you want to use a <code><a href='https://rdrr.io/pkg/phyloseq/man/UniFrac-methods.html'>UniFrac</a></code>-based distance
(in which case your <code>physeq</code> data would need to have a tree included).</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>(Optional).
The ordination method to use for organizing the
heatmap. A great deal of the usefulness of a heatmap graphic depends upon
the way in which the rows and columns are ordered.</p></td>
    </tr>
    <tr>
      <th>distance</th>
      <td><p>(Optional). A character string.
The ecological distance method to use in the ordination.
See <code><a href='https://rdrr.io/pkg/phyloseq/man/distance.html'>distance</a></code>.</p></td>
    </tr>
    <tr>
      <th>sample.label</th>
      <td><p>(Optional). A character string.
The sample variable by which you want to re-label the sample (horizontal) axis.</p></td>
    </tr>
    <tr>
      <th>taxa.label</th>
      <td><p>(Optional). A character string.
The name of the taxonomic rank by which you want to
re-label the taxa/species/OTU (vertical) axis.
You can see available options in your data using
<code><a href='https://rdrr.io/pkg/phyloseq/man/rank_names.html'>rank_names</a>(physeq)</code>.</p></td>
    </tr>
    <tr>
      <th>low</th>
      <td><p>(Optional). A character string. An R color.
See <code>?<a href='https://rdrr.io/r/grDevices/colors.html'>colors</a></code> for options support in R (there are lots).
The color that represents the lowest non-zero value
in the heatmap. Default is a dark blue color, <code>"#000033"</code>.</p></td>
    </tr>
    <tr>
      <th>high</th>
      <td><p>(Optional). A character string. An R color.
See <code><a href='https://rdrr.io/r/grDevices/colors.html'>colors</a></code> for options support in R (there are lots).
The color that will represent the highest
value in the heatmap. The default is <code>"#66CCFF"</code>.
Zero-values are treated as <code>NA</code>, and set to <code>"black"</code>, to represent
a background color.</p></td>
    </tr>
    <tr>
      <th>na.value</th>
      <td><p>(Optional). A character string. An R color.
See <code><a href='https://rdrr.io/r/grDevices/colors.html'>colors</a></code> for options support in R (there are lots).
The color to represent what is essentially the background of the plot,
the non-observations that occur as <code>NA</code> or
<code>0</code> values in the abundance table. The default is <code>"black"</code>, which
works well on computer-screen graphics devices, but may be a poor choice for
printers, in which case you might want this value to be <code>"white"</code>, and
reverse the values of <code>high</code> and <code>low</code>, above.</p></td>
    </tr>
    <tr>
      <th>trans</th>
      <td><p>(Optional). <code>"trans"</code>-class transformer-definition object.
A numerical transformer to use in
the continuous color scale. See <code><a href='https://scales.r-lib.org/reference/trans_new.html'>trans_new</a></code> for details.
The default is <code>log_trans(4)</code>.</p></td>
    </tr>
    <tr>
      <th>max.label</th>
      <td><p>(Optional). Integer. Default is 250.
The maximum number of labeles to fit on a given axis (either x or y).
If number of taxa or samples exceeds this value,
the corresponding axis will be stripped of any labels.</p>
<p>This supercedes any arguments provided to
<code>sample.label</code> or <code>taxa.label</code>.
Make sure to increase this value if, for example,
you want a special label
for an axis that has 300 indices.</p></td>
    </tr>
    <tr>
      <th>title</th>
      <td><p>(Optional). Default <code>NULL</code>. Character string.
The main title for the graphic.</p></td>
    </tr>
    <tr>
      <th>sample.order</th>
      <td><p>(Optional). Default <code>NULL</code>.
Either a single character string matching
one of the <code><a href='https://rdrr.io/pkg/phyloseq/man/sample_variables.html'>sample_variables</a></code> in your data,
or a character vector of <code><a href='https://rdrr.io/pkg/phyloseq/man/sample_names-methods.html'>sample_names</a></code>
in the precise order that you want them displayed in the heatmap.
This overrides any ordination ordering that might be done
with the <code>method</code>/<code>distance</code> arguments.</p></td>
    </tr>
    <tr>
      <th>taxa.order</th>
      <td><p>(Optional). Default <code>NULL</code>.
Either a single character string matching
one of the <code><a href='https://rdrr.io/pkg/phyloseq/man/rank_names.html'>rank_names</a></code> in your data,
or a character vector of <code><a href='https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html'>taxa_names</a></code>
in the precise order that you want them displayed in the heatmap.
This overrides any ordination ordering that might be done
with the <code>method</code>/<code>distance</code> arguments.</p></td>
    </tr>
    <tr>
      <th>first.sample</th>
      <td><p>(Optional). Default <code>NULL</code>.
A character string matching one of the <code><a href='https://rdrr.io/pkg/phyloseq/man/sample_names-methods.html'>sample_names</a></code>
of your input data (<code>physeq</code>).
It will become the left-most sample in the plot.
For the ordination-based ordering (recommended),
the left and right edges of the axes are adjaacent in a continuous ordering.
Therefore, the choice of starting sample is meaningless and arbitrary,
but it is aesthetically poor to have the left and right edge split
a natural cluster in the data.
This argument allows you to specify the left edge
and thereby avoid cluster-splitting, emphasize a gradient, etc.</p></td>
    </tr>
    <tr>
      <th>first.taxa</th>
      <td><p>(Optional). Default <code>NULL</code>.
A character string matching one of the <code><a href='https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html'>taxa_names</a></code>
of your input data (<code>physeq</code>).
This is equivalent to <code>first.sample</code> (above),
but for the taxa/OTU indices, usually the vertical axis.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>(Optional). Additional parameters passed to <code><a href='https://rdrr.io/pkg/phyloseq/man/ordinate.html'>ordinate</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A heatmap plot, in the form of a <code>ggplot2</code> plot object,
which can be further saved and modified.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This approach borrows heavily from the <code>heatmap1</code> function in the
<code>NeatMap</code> package. Highly recommended, and we are grateful for their
package and ideas, which we have adapted for our specific purposes here,
but did not use an explicit dependency. At the time of the first version
of this implementation, the NeatMap package depends on the rgl-package,
which is not needed in phyloseq, at present. Although likely a transient
issue, the rgl-package has some known installation issues that have further
influenced to avoid making NeatMap a formal dependency (Although we love
both NeatMap and rgl!).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Because this function relies so heavily in principle, and in code, on some of the
functionality in NeatMap, please site their article if you use this function
in your work.</p>
<p>Rajaram, S., &amp; Oono, Y. (2010).
NeatMap--non-clustering heat map alternatives in R. BMC Bioinformatics, 11, 45.</p>
<p>Please see further examples in the
<a href='http://joey711.github.io/phyloseq/plot_heatmap-examples'>phyloseq online tutorials</a>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"GlobalPatterns"</span><span class='op'>)</span>
<span class='va'>gpac</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/phyloseq/man/subset_taxa-methods.html'>subset_taxa</a></span><span class='op'>(</span><span class='va'>GlobalPatterns</span>, <span class='va'>Phylum</span><span class='op'>==</span><span class='st'>"Crenarchaeota"</span><span class='op'>)</span>
<span class='co'># FYI, the base-R function uses a non-ecological ordering scheme,</span>
<span class='co'># but does add potentially useful hclust dendrogram to the sides...</span>
<span class='va'>gpac</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/phyloseq/man/subset_taxa-methods.html'>subset_taxa</a></span><span class='op'>(</span><span class='va'>GlobalPatterns</span>, <span class='va'>Phylum</span><span class='op'>==</span><span class='st'>"Crenarchaeota"</span><span class='op'>)</span>
<span class='co'># Remove the nearly-empty samples (e.g. 10 reads or less)</span>
<span class='va'>gpac</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/phyloseq/man/prune_samples-methods.html'>prune_samples</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/phyloseq/man/sample_sums.html'>sample_sums</a></span><span class='op'>(</span><span class='va'>gpac</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>50</span>, <span class='va'>gpac</span><span class='op'>)</span>
<span class='co'># Arbitrary order if method set to NULL</span>
<span class='fu'>plot_heatmap</span><span class='op'>(</span><span class='va'>gpac</span>, method<span class='op'>=</span><span class='cn'>NULL</span>, sample.label<span class='op'>=</span><span class='st'>"SampleType"</span>,
  taxa.label<span class='op'>=</span><span class='st'>"Family"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Transformation introduced infinite values in discrete y-axis</span></div><div class='img'><img src='plot_heatmap-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Use ordination</span>
<span class='fu'>plot_heatmap</span><span class='op'>(</span><span class='va'>gpac</span>, sample.label<span class='op'>=</span><span class='st'>"SampleType"</span>, taxa.label<span class='op'>=</span><span class='st'>"Family"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Transformation introduced infinite values in discrete y-axis</span></div><div class='img'><img src='plot_heatmap-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Use ordination for OTUs, but not sample-order</span>
<span class='fu'>plot_heatmap</span><span class='op'>(</span><span class='va'>gpac</span>, sample.label<span class='op'>=</span><span class='st'>"SampleType"</span>, taxa.label<span class='op'>=</span><span class='st'>"Family"</span>,
  sample.order<span class='op'>=</span><span class='st'>"SampleType"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Transformation introduced infinite values in discrete y-axis</span></div><div class='img'><img src='plot_heatmap-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Specifying both orders omits any attempt to use ordination. The following</span>
<span class='co'># should be the same.</span>
<span class='va'>p0</span> <span class='op'>=</span> <span class='fu'>plot_heatmap</span><span class='op'>(</span><span class='va'>gpac</span>, sample.label<span class='op'>=</span><span class='st'>"SampleType"</span>, taxa.label<span class='op'>=</span><span class='st'>"Family"</span>,
  taxa.order<span class='op'>=</span><span class='st'>"Phylum"</span>, sample.order<span class='op'>=</span><span class='st'>"SampleType"</span><span class='op'>)</span>
<span class='va'>p1</span> <span class='op'>=</span> <span class='fu'>plot_heatmap</span><span class='op'>(</span><span class='va'>gpac</span>, method<span class='op'>=</span><span class='cn'>NULL</span>, sample.label<span class='op'>=</span><span class='st'>"SampleType"</span>,
  taxa.label<span class='op'>=</span><span class='st'>"Family"</span>, taxa.order<span class='op'>=</span><span class='st'>"Phylum"</span>, sample.order<span class='op'>=</span><span class='st'>"SampleType"</span><span class='op'>)</span>
<span class='co'>#expect_equivalent(p0, p1)</span>
<span class='co'># Example: Order matters. Random ordering of OTU indices is difficult to</span>
<span class='co'># interpret, even with structured sample order</span>
<span class='va'>rando</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html'>taxa_names</a></span><span class='op'>(</span><span class='va'>gpac</span><span class='op'>)</span>, size<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/phyloseq/man/ntaxa-methods.html'>ntaxa</a></span><span class='op'>(</span><span class='va'>gpac</span><span class='op'>)</span>, replace<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'>plot_heatmap</span><span class='op'>(</span><span class='va'>gpac</span>, method<span class='op'>=</span><span class='cn'>NULL</span>, sample.label<span class='op'>=</span><span class='st'>"SampleType"</span>,
  taxa.label<span class='op'>=</span><span class='st'>"Family"</span>, taxa.order<span class='op'>=</span><span class='va'>rando</span>, sample.order<span class='op'>=</span><span class='st'>"SampleType"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Transformation introduced infinite values in discrete y-axis</span></div><div class='img'><img src='plot_heatmap-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># # Select the edges of each axis. </span>
<span class='co'># First, arbitrary edge, ordering</span>
<span class='fu'>plot_heatmap</span><span class='op'>(</span><span class='va'>gpac</span>, method<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Transformation introduced infinite values in discrete y-axis</span></div><div class='img'><img src='plot_heatmap-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Second, biological-ordering (instead of default ordination-ordering), but</span>
<span class='co'># arbitrary edge</span>
<span class='fu'>plot_heatmap</span><span class='op'>(</span><span class='va'>gpac</span>, taxa.order<span class='op'>=</span><span class='st'>"Family"</span>, sample.order<span class='op'>=</span><span class='st'>"SampleType"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Transformation introduced infinite values in discrete y-axis</span></div><div class='img'><img src='plot_heatmap-6.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Third, biological ordering, selected edges</span>
<span class='fu'>plot_heatmap</span><span class='op'>(</span><span class='va'>gpac</span>, taxa.order<span class='op'>=</span><span class='st'>"Family"</span>, sample.order<span class='op'>=</span><span class='st'>"SampleType"</span>,
  first.taxa<span class='op'>=</span><span class='st'>"546313"</span>, first.sample<span class='op'>=</span><span class='st'>"NP2"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Transformation introduced infinite values in discrete y-axis</span></div><div class='img'><img src='plot_heatmap-7.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># Fourth, add meaningful labels</span>
<span class='fu'>plot_heatmap</span><span class='op'>(</span><span class='va'>gpac</span>, sample.label<span class='op'>=</span><span class='st'>"SampleType"</span>, taxa.label<span class='op'>=</span><span class='st'>"Family"</span>,
  taxa.order<span class='op'>=</span><span class='st'>"Family"</span>, sample.order<span class='op'>=</span><span class='st'>"SampleType"</span>, first.taxa<span class='op'>=</span><span class='st'>"546313"</span>,
  first.sample<span class='op'>=</span><span class='st'>"NP2"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Transformation introduced infinite values in discrete y-axis</span></div><div class='img'><img src='plot_heatmap-8.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Michael McLaren.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


