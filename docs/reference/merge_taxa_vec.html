<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Merge taxa in groups (vectorized version) — merge_taxa_vec • speedyseq</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Merge taxa in groups (vectorized version) — merge_taxa_vec" />
<meta property="og:description" content="Merge taxa in x into a smaller set of taxa defined by the vector group.
Taxa whose value in group is NA will be dropped. New taxa will be named
according to the most abundant taxon in each group (phyloseq and
otu_table objects) or the first taxon in each group (all other phyloseq
component objects)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">speedyseq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.3.9010</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mikemc/speedyseq/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Merge taxa in groups (vectorized version)</h1>
    <small class="dont-index">Source: <a href='https://github.com/mikemc/speedyseq/blob/master/R/merge_taxa_vec.R'><code>R/merge_taxa_vec.R</code></a></small>
    <div class="hidden name"><code>merge_taxa_vec.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Merge taxa in <code>x</code> into a smaller set of taxa defined by the vector <code>group</code>.
Taxa whose value in <code>group</code> is NA will be dropped. New taxa will be named
according to the most abundant taxon in each group (<code>phyloseq</code> and
<code>otu_table</code> objects) or the first taxon in each group (all other phyloseq
component objects).</p>
    </div>

    <pre class="usage"><span class='fu'>merge_taxa_vec</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>group</span>, reorder <span class='op'>=</span> <span class='cn'>FALSE</span>, tax_adjust <span class='op'>=</span> <span class='fl'>1L</span><span class='op'>)</span>

<span class='co'># S4 method for phyloseq</span>
<span class='fu'>merge_taxa_vec</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>group</span>, reorder <span class='op'>=</span> <span class='cn'>FALSE</span>, tax_adjust <span class='op'>=</span> <span class='fl'>1L</span><span class='op'>)</span>

<span class='co'># S4 method for otu_table</span>
<span class='fu'>merge_taxa_vec</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>group</span>, reorder <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'># S4 method for taxonomyTable</span>
<span class='fu'>merge_taxa_vec</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>group</span>, reorder <span class='op'>=</span> <span class='cn'>FALSE</span>, tax_adjust <span class='op'>=</span> <span class='fl'>1L</span><span class='op'>)</span>

<span class='co'># S4 method for phylo</span>
<span class='fu'>merge_taxa_vec</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>group</span><span class='op'>)</span>

<span class='co'># S4 method for XStringSet</span>
<span class='fu'>merge_taxa_vec</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>group</span>, reorder <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A phyloseq object or component object</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>A vector with one element for each taxon in <code>physeq</code> that
defines the new groups. see <code><a href='https://rdrr.io/r/base/rowsum.html'>base::rowsum()</a></code>.</p></td>
    </tr>
    <tr>
      <th>reorder</th>
      <td><p>Logical specifying whether to reorder the taxa by their
<code>group</code> values. Ignored if <code>x</code> has (or is) a phylogenetic tree.</p></td>
    </tr>
    <tr>
      <th>tax_adjust</th>
      <td><p>0: no adjustment; 1: phyloseq-compatible adjustment; 2:
conservative adjustment</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If <code>x</code> is a phyloseq object with a phylogenetic tree, then the new taxa will
be ordered as they are in the tree. Otherwise, the taxa order can be
controlled by the <code>reorder</code> argument, which behaves like the <code>reorder</code>
argument in <code><a href='https://rdrr.io/r/base/rowsum.html'>base::rowsum()</a></code>. <code>reorder = FALSE</code> will keep taxa in
the original order determined by when the member of each group first appears
in <code><a href='https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html'>taxa_names(x)</a></code>; <code>reorder = TRUE</code> will order new taxa according to their
corresponding value in <code>group</code>.</p>
<p>The <code>tax_adjust</code> argument controls the handling of taxonomic disagreements
within groups. Setting <code>tax_adjust == 0</code> causes no adjustment; the taxonomy
of the new group is set to the archetype taxon (see below). Otherwise,
disagreements within a group at a given rank cause the values at lower ranks
to be set to <code>NA</code>. If <code>tax_adjust == 1</code> (the default), then a rank where all
taxa in the group are already NA is not counted as a disagreement, and lower
ranks may be kept if the taxa agree. This corresponds to the original
phyloseq behavior. If <code>tax_adjust == 2</code>, then these NAs are treated as a
disagreement; all ranks are set to NA after the first disagreement or NA.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Merging functions that use this function: <code><a href='tax_glom.html'>tax_glom()</a></code>, <code><a href='tip_glom.html'>tip_glom()</a></code>,
<code><a href='tree_glom.html'>tree_glom()</a></code></p>
<p><code><a href='https://rdrr.io/r/base/rowsum.html'>base::rowsum()</a></code></p>
<p><code><a href='https://rdrr.io/pkg/phyloseq/man/merge_taxa-methods.html'>phyloseq::merge_taxa()</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># Create 97% OTUs from a phyloseq object with reference sequences</span>
<span class='co'># Assume ps is a phyloseq object with refseq slot</span>
<span class='va'>dna</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/phyloseq/man/refseq-methods.html'>refseq</a></span><span class='op'>(</span><span class='va'>ps</span><span class='op'>)</span>
<span class='va'>nproc</span> <span class='op'>&lt;-</span> <span class='fl'>1</span> <span class='co'># Increase to use multiple processors</span>
<span class='va'>aln</span> <span class='op'>&lt;-</span> <span class='fu'>DECIPHER</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/DECIPHER/man/AlignSeqs.html'>AlignSeqs</a></span><span class='op'>(</span><span class='va'>dna</span>, processors <span class='op'>=</span> <span class='va'>nproc</span><span class='op'>)</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'>DECIPHER</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/DECIPHER/man/DistanceMatrix.html'>DistanceMatrix</a></span><span class='op'>(</span><span class='va'>aln</span>, processors <span class='op'>=</span> <span class='va'>nproc</span><span class='op'>)</span>
<span class='va'>clusters</span> <span class='op'>&lt;-</span> <span class='fu'>DECIPHER</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/DECIPHER/man/IdClusters.html'>IdClusters</a></span><span class='op'>(</span>
  <span class='va'>d</span>, 
  method <span class='op'>=</span> <span class='st'>"complete"</span>,
  cutoff <span class='op'>=</span> <span class='fl'>0.03</span>,
  processors <span class='op'>=</span> <span class='va'>nproc</span>
<span class='op'>)</span>
<span class='va'>ps0</span> <span class='op'>&lt;-</span> <span class='fu'>merge_taxa_vec</span><span class='op'>(</span>
  <span class='va'>ps</span>, 
  group <span class='op'>=</span> <span class='va'>clusters</span><span class='op'>$</span><span class='va'>cluster</span>,
<span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Michael McLaren.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


